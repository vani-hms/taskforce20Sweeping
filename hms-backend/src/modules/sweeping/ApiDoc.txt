ğŸ§¹ SWEEPING MODULE â€” API DOC

Base path assumed:

/api/sweeping


(All routes already protected by authenticate + requireCityContext)

Auth headers:

Authorization: Bearer <token>
x-city-id: <cityId>

ğŸŸ¥ CITY ADMIN
1ï¸âƒ£ Upload KML â†’ Create Beats
POST
/admin/upload-kml

FormData
Key	Type
file	KML file
Logic

âœ” Reads KML
âœ” Extracts ward from beat name
âœ” Creates GeoNode (BEAT)
âœ” Creates SweepingBeat
âœ” Auto radius = 10 meters

Response
{
  "createdBeats": 12
}


Frontend:

ğŸ‘‰ Admin â†’ Upload KML page
ğŸ‘‰ File picker
ğŸ‘‰ Submit multipart form

2ï¸âƒ£ Assign Beat to Employee
POST
/admin/assign-beat

Body
{
  "sweepingBeatId": "uuid",
  "employeeId": "uuid"
}

Response
{
  "beat": { ... }
}


Frontend:

ğŸ‘‰ Admin Beat List
ğŸ‘‰ Dropdown employee
ğŸ‘‰ Assign button

ğŸŸ© EMPLOYEE
3ï¸âƒ£ Get My Assigned Beats
GET
/employee/beats

Response
{
  "beats": [
    {
      "id": "...",
      "geoNodeBeat": { ... }
    }
  ]
}


Frontend:

ğŸ‘‰ Employee Dashboard
ğŸ‘‰ Show beat cards/map

4ï¸âƒ£ Submit Inspection
POST
/inspections/submit

Body
{
  "sweepingBeatId": "uuid",
  "latitude": 22.7,
  "longitude": 75.8,
  "answers": [
    {
      "questionCode": "Q1",
      "answer": true,
      "photos": ["url1","url2"]
    }
  ]
}

Backend checks:

âœ… Beat belongs to employee
âœ… User inside 10m radius
âœ… Saves inspection
âœ… Saves answers
âœ… Saves photos

Response
{
  "inspection": { ... }
}


Frontend:

ğŸ‘‰ Beat Detail Screen
ğŸ‘‰ GPS capture
ğŸ‘‰ Questionnaire
ğŸ‘‰ Upload photos
ğŸ‘‰ Submit

ğŸŸ¨ QC
5ï¸âƒ£ QC â€” List Inspections
GET
/qc/inspections

Response
{
  "inspections": [
    {
      "sweepingBeat": {...},
      "employee": {...},
      "answers": [...],
      "photos": [...]
    }
  ]
}


Frontend:

ğŸ‘‰ QC Dashboard
ğŸ‘‰ Inspection table

6ï¸âƒ£ QC Decision
POST
/qc/inspections/:id/decision

Body
{
  "decision": "APPROVED"
}


Values:

APPROVED
REJECTED
ACTION_REQUIRED


Frontend:

ğŸ‘‰ Approve / Reject / Action Required buttons

7ï¸âƒ£ QC â€” View All Beats
GET
/qc/beats

Response
{
  "beats": [
    {
      "geoNodeBeat": {},
      "assignedEmployee": {
        "id": "",
        "name": "",
        "email": ""
      }
    }
  ]
}


Frontend:

ğŸ‘‰ QC Beat Overview

ğŸŸ¦ ACTION OFFICER
8ï¸âƒ£ Get Action Required Inspections
GET
/action/required

Response
{
  "inspections": []
}


Frontend:

ğŸ‘‰ Action Officer Dashboard

9ï¸âƒ£ Submit Action Response
POST
/action/:inspectionId/respond

Body
{
  "remarks": "done",
  "photos": ["url1"]
}

Response
{
  "actionResponse": { ... }
}


Also automatically sets inspection status:

ACTION_SUBMITTED


Frontend:

ğŸ‘‰ Action submission form
ğŸ‘‰ Upload evidence
ğŸ‘‰ Submit

ğŸ” STATUS FLOW (IMPORTANT FOR FRONTEND)
SUBMITTED (employee)
â†“
QC decision
â†“
APPROVED / REJECTED / ACTION_REQUIRED
â†“
Action Officer submits
â†“
ACTION_SUBMITTED